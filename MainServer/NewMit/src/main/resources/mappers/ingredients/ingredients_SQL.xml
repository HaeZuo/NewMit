<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTO Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mappers.ingredients">

    <insert id="insertIngredientsOwned" parameterType="map">
        /* mappers.ingredients.insertIngredientsOwned */
        INSERT INTO TB_INGREDIENTS_OWNED(
            MB_NO,
            INGREDIENT_OWNED_NO,
            INGREDIENT_OWNED_NM,
            INGREDIENT_OWNED_TYPE,
            INGREDIENT_OWNED_QOW,
            INGREDIENT_OWNED_BUY_DATE,
            INGREDIENT_OWNED_EXPIRATION_DATE,
            INGREDIENT_OWNED_IMAGE_ID,
            INGREDIENT_OWNED_REGISTER_DATE,
            INGREDIENT_OWNED_REGISTER_IP
        )
        VALUES(
                #{mbNo},
                #{ingredientOwnedNo},
                #{ingredientOwnedNm},
                #{ingredientOwnedType},
                #{ingredientOwnedQow},
                #{ingredientOwnedBuyDate},
                #{ingredientOwnedExpirationDate},
                #{ingredientOwnedImageId},
                now(),
                #{userIp}
              )
    </insert>

    <select id="selectMaxIngredientOwnedNo" parameterType="string" resultType="string">
        /* mappers.ingredients.selectMaxIngredientOwnedNo */
        SELECT IFNULL(MAX(INGREDIENT_OWNED_NO), '0') + 1
        FROM TB_INGREDIENTS_OWNED
        WHERE MB_NO = #{userId}
    </select>

    <select id="selectIngredientsOwned" parameterType="map" resultType="map">
        /* mappers.ingredients.selectIngredientsOwned */
        SELECT
            TIO.INGREDIENT_OWNED_NO,
            TIO.INGREDIENT_OWNED_NM,
            TIO.INGREDIENT_OWNED_TYPE,
            TIO.INGREDIENT_OWNED_QOW,
            TIO.INGREDIENT_OWNED_BUY_DATE,
            TIO.INGREDIENT_OWNED_EXPIRATION_DATE,
            TIO.INGREDIENT_OWNED_IMAGE_ID
        FROM TB_INGREDIENTS_OWNED TIO
        WHERE 1=1
        AND TIO.MB_NO = #{userId}
        AND TIO.INGREDIENT_OWNED_TYPE = #{ingredientOwnedType}
    </select>

    <select id="selectIngredientsListDetail" parameterType="map" resultType="map">
        /* mappers.ingredients.selectIngredientsListDetail */
        SELECT
            TIO.INGREDIENT_OWNED_NO,
            TIO.INGREDIENT_OWNED_NM,
            TIO.INGREDIENT_OWNED_TYPE,
            TIO.INGREDIENT_OWNED_QOW,
            TIO.INGREDIENT_OWNED_BUY_DATE,
            TIO.INGREDIENT_OWNED_EXPIRATION_DATE,
            TIO.INGREDIENT_OWNED_IMAGE_ID
        FROM TB_INGREDIENTS_OWNED TIO
        WHERE 1=1
          AND TIO.MB_NO = #{userId}
          AND TIO.INGREDIENT_OWNED_TYPE = #{foodIngredientsTypeCode}
    </select>

</mapper>